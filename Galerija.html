<!DOCTYPE html>
<html lang="en">
<head>
    <base href="pictures/">
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–ì–∞–ª–µ—Ä–∏—ò–∞</title>
    <style>
        body, html {
            margin: 0; padding: 0;
            font-family: 'Georgia', serif;
            height: 100%;
            overflow-x: hidden;
        }
        .library-container {
            position: relative;
            background: url('pictures/gallery.webp') no-repeat center center/cover;
            height: 100vh;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .score-container {
            font-size: 16px;
            font-weight: 700;
            color: #fff;
            text-shadow: 1px 1px 6px #000;
            font-family: 'Georgia', serif;
            text-align: center;
            margin: 0;
        }
        .overlay {
            position: absolute;
            inset: 0;
            background-color: rgba(0,0,0,0.5);
            z-index: 0;
        }
        #modal {
            display: none;
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(3px);
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        #modal[aria-hidden="true"] {
            display: none;
        }
        #modal-content {
            background: #5c3317;
            border-radius: 12px;
            padding: 20px;
            width: 320px;
            max-width: 90vw;
            max-height: 70vh;
            overflow-y: auto;
            box-shadow: 0 0 20px #7a5b33cc;
            color: #fff;
            font-family: 'Georgia', serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
            position: relative;
            text-align: center;
        }
        #modal img.modal-image {
            width: 100%;
            border-radius: 12px;
            object-fit: contain;
        }
        #modal-close {
            position: absolute;
            top: 12px;
            right: 15px;
            font-size: 28px;
            color: #b4996a;
            background: transparent;
            border: none;
            cursor: pointer;
            user-select: none;
            font-weight: 900;
            transition: color 0.3s ease;
        }
        #modal-close:hover {
            color: #f0e6c8;
        }
        .dialogue {
            display: flex;
            gap: 20px;
            justify-content: center;
            align-items: center;
        }
        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 0 0 6px rgba(0,0,0,0.4);
            flex-shrink: 0;
            background-color: #f3e9dc;
        }
        .avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .speech-bubble {
            background: #735643;
            border-radius: 12px;
            padding: 10px 15px;
            font-size: 14px;
            box-shadow: 0 0 8px rgba(207, 161, 120, 0.67);
            max-width: 180px;
            color: #fff;
            font-family: 'Georgia', serif;
        }
        .speech-bubble.user {
            background: #6b4c2a;
            font-size: 10px;
        }
        .speech-bubble.novinarka {
            font-size: 10px;
        }
        .main-button {
            padding: 10px 20px;
            background: linear-gradient(145deg, #8b5e3c, #5d3a1a);
            border: 3px solid #6b4c2b;
            border-radius: 50px;
            box-shadow:
                    0 0 12px #7a5b33cc,
                    inset 0 -3px 6px #3d2f1b;
            font-weight: 900;
            font-size: 14px;
            color: #f5e1c0;
            cursor: pointer;
            text-transform: uppercase;
            user-select: none;
            font-family: 'Georgia', serif;
            transition: transform 0.2s ease, box-shadow 0.3s ease;
        }
        .main-button:hover:not(:disabled) {
            transform: scale(1.1);
            box-shadow:
                    0 0 20px #b4996acc,
                    inset 0 -5px 10px #8b6e3f;
        }
        .main-button:disabled {
            opacity: 0.5;
            cursor: default;
            box-shadow: none;
        }
        body.modal-open {
            overflow: hidden;
        }
        .lock-icon {
            width: 32px;
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 2;
        }
        .card-content {
            padding: 15px;
            color: #fff;
            font-size: 13px;
        }
        .cards-container {
            position: relative;
            z-index: 1;
            display: flex;
            gap: 15px;
            flex-wrap: nowrap;
            justify-content: center;
        }
        .card {
            width: 180px;
            background: linear-gradient(to bottom, #8b5e3c, #5c3b1e);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 6px 12px rgba(0,0,0,0.4);
            position: relative;
            transition: transform 0.3s;
            cursor: pointer;
        }
        .article-img {
            width: 100%;
            height: 110px;
            object-fit: cover;
            display: block;
        }

    </style>
</head>
<body>

<div class="library-container">

    <h3 style="color: white; text-shadow: 1px 1px 6px black; margin-bottom: 20px;">–ì–∞–ª–µ—Ä–∏—ò–∞</h3>

    <div class="cards-container">
        <div class="card locked" onclick="window.location.href='GalerijaNivo.html';">
            <img src="pictures/naturepic1.PNG" alt="Article 4" class="article-img" />
            <img src="pictures/lock.png" alt="Locked" class="lock-icon" />
            <div class="card-content">
                <p> –ù–∞—É—á–∏ –≥–∏ –∫–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏—Ç–µ –Ω–∞ –≤–µ—à—Ç–∞—á–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∏ –∏ –ø—Ä–∏—Ä–æ–¥–Ω–∏ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏Ô∏èüì∏üñºÔ∏è</p>
                <p style="font-size: 10px" >(–°—Ç–∞–≤–∏ –≥–∏ —Å–æ–æ–¥–≤–µ—Ç–Ω–∏—Ç–µ –∫–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤–æ —Å–æ–æ–¥–≤–µ—Ç–Ω–∞—Ç–∞ —Ä–∞–º–∫–∞)</p>
            </div>
        </div>

        <div class="card locked" onclick="window.location.href='GalerijaNivo2.html';">
            <img src="pictures/12345.jpg" alt="Article 5" class="article-img" />
            <img src="pictures/lock.png" alt="Locked" class="lock-icon" />
            <div class="card-content">
                <p> –†–µ—à–∏ –≥–æ –∫–≤–∏–∑–æ—Ç Ô∏èüì∏üñºÔ∏è –ü—Ä–∏—Ä–æ–¥–Ω–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—ò–∞ –∏–ª–∏ –≥–µ–Ω–µ—Ä–∏—Ä–∞–Ω–∞ —Å–æ –≤–µ—à—Ç–∞—á–∫–∞ –∏–Ω—Ç–µ–ª–∏–≥–µ–Ω—Ü–∏—ò–∞?</p>
                <p style="font-size: 10px" >(–ò—Å–∫–æ—Ä–∏—Å—Ç–∏ –≥–æ –∑–Ω–∞–µ—ö–µ—Ç–æ –∫–æ–µ –≥–æ —Å—Ç–µ–∫–Ω–∞ –∏ –ø–æ–≥–æ–¥—É–≤–∞—ò —Å–ø–æ—Ä–µ–¥ –∫–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏—Ç–µ)</p>
            </div>
        </div>
    </div>

    <div class="score-container">
        <p>Score: <span id="score-display">0</span> / 33 </p>
    </div>
</div>

<div id="modal" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div id="modal-content">
        <button id="modal-close" aria-label="Close modal">&times;</button>
        <img src="pictures/gallerymodal.PNG" alt="Modal Image" class="modal-image" />
        <div class="dialogue">
            <div class="avatar">
                <img src="pictures/galerijamen.png" alt="–ù–æ–≤–∏–Ω–∞—Ä–∫–∞" />
            </div>
            <div class="speech-bubble novinarka" id="modal-title">üëã –ó–¥—Ä–∞–≤–æ! –î–æ–±—Ä–µ–¥–æ—ò–¥–µ –≤–æ –≥–∞–ª–µ—Ä–∏—ò–∞—Ç–∞. –à–∞—Å —Å—É–º –µ–∫—Å–ø–µ—Ä—Ç –∑–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –∏ —Ç—É–∫–∞ —Å—É–º –¥–∞ —Ç–∏ –ø–æ–º–æ–≥–Ω–∞–º.</div>
        </div>
        <div class="dialogue" style="justify-content: flex-end; margin-top: 10px;">
            <div class="speech-bubble user"> üëã –ó–¥—Ä–∞–≤–æ –∏ —Ç–µ–±–µ! –ú–æ–∂–µ –¥–∞ –ø–æ—á–Ω–µ–º–µ.üéâ </div>
            <div class="avatar" id="avatar-container"></div>
        </div>
        <button id="start-button" class="main-button" disabled>–°–¢–ê–†–¢</button>
    </div>
</div>

<script>
    const gender = sessionStorage.getItem('selectedGender');
    const avatarContainer = document.getElementById('avatar-container');
    if (gender === 'female') {
        avatarContainer.innerHTML = '<img src="pictures/female.png" alt="–ñ–µ–Ω—Å–∫–∏ –∞–≤–∞—Ç–∞—Ä" />';
    } else if (gender === 'male') {
        avatarContainer.innerHTML = '<img src="pictures/male.png" alt="–ú–∞—à–∫–∏ –∞–≤–∞—Ç–∞—Ä" />';
    } else {
        avatarContainer.innerHTML = '<img src="default.png" alt="–°—Ç–∞–Ω–¥–∞—Ä–¥–Ω–∞ —Å–ª–∏–∫–∞" />';
    }

    let currentScoreNivo1 = parseFloat(sessionStorage.getItem('scoreNivo1')) || 0;
    let currentScoreNivo2 = parseFloat(sessionStorage.getItem('scoreNivo2')) || 0;
    let totalScore = currentScoreNivo1 + currentScoreNivo2;
    document.getElementById('score-display').textContent = Math.round(totalScore);
    sessionStorage.setItem('totalScore', totalScore.toString());

    const modal = document.getElementById('modal');
    const modalClose = document.getElementById('modal-close');
    const startButton = document.getElementById('start-button');

    function openModal() {
        modal.style.display = 'flex';
        modal.setAttribute('aria-hidden', 'false');
        document.body.classList.add('modal-open');
    }
    function closeModal() {
        modal.style.display = 'none';
        modal.setAttribute('aria-hidden', 'true');
        document.body.classList.remove('modal-open');
    }
    const redirectTimeout = 1500;
    window.addEventListener('load', () => {
        const referrer = document.referrer || '';
        if (referrer.includes('index.html')) {
            openModal();
        }
        if (referrer.includes('GalerijaNivo2.html')) {
            setTimeout(() => {
                let currentScoreNivo1 = parseFloat(sessionStorage.getItem('scoreNivo1')) || 0;
                let currentScoreNivo2 = parseFloat(sessionStorage.getItem('scoreNivo2')) || 0;
                let totalScore = currentScoreNivo1 + currentScoreNivo2;
                sessionStorage.setItem('GalleryScore', totalScore.toString());
                window.location.href = 'index.html';
            }, redirectTimeout);
        }
    });
    modalClose.onclick = closeModal;
    setTimeout(() => {
        startButton.disabled = false;
    }, 1000);
    startButton.onclick = () => {
        closeModal();
    };
</script>

</body>
</html>
